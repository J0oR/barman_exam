<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Drink Selector</title>

    <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
    <link rel="manifest" href="./favicon/site.webmanifest">
    <link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="./assets/css/training.css">

    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Reddit+Mono:wght@200..900&display=swap" rel="stylesheet">
</head>

<body>

    <nav>
        <ul>
            <li class="selected-page">
                <a href="../index.html">
                    <button class="nav-btn">Training</button>
                </a>
            </li>
            <li>
                <a href="pages/tecniche.html">
                    <button class="nav-btn">Tecniche</button>
                </a>
            </li>
        </ul>
    </nav>


    <div class="container">

        <button id="randomButton" class="random-btn">Get a Random Drink</button>

        <div class="cocktail-card">
            <img src="" alt="" id="cocktail-img" class="cocktail-img">
            <div id="result" class="cocktail-name"></div>
            <button id="recipeButton" class="recipe-btn">
                <span>Show Recipe</span>
                <img src="assets/icon/arrow.png" alt="" class="btn-icon">
            </button>
        </div>

        <div id="recipe" class="recipe-card">
            <div class="recipe-element-header">Tecnica</div>
            <div id="technique"></div>
            <br>
            <div class="recipe-element-header">Glass</div>
            <div id="glass"></div>
            <br>
            <div class="recipe-element-header">Recipe</div>
            <div id="ingredients"></div>
            <br>
            <div class="recipe-element-header">Garnish</div>
            <div id="garnish"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const files = [
                './assets/data/build-a.json',
                './assets/data/build-b.json',
                './assets/data/dryshake.json',
                './assets/data/muddler.json',
                './assets/data/stir-strain.json',
                './assets/data/shake-strain.json'
            ];

            Promise.all(files.map(file => fetch(file).then(response => response.json())))
                .then(allData => {
                    // Combine all data into a single array
                    const drinks = allData.flat();
                    let currentDrink = null;
                    document.querySelector('.cocktail-card').classList.add('hidden');
                    document.querySelector('.recipe-card').classList.add('hidden');

                    document.getElementById('randomButton').addEventListener('click', function () {
                        const randomIndex = Math.floor(Math.random() * drinks.length);
                        currentDrink = drinks[randomIndex];
                        document.getElementById('result').innerText = currentDrink.name;
                        document.getElementById('cocktail-img').setAttribute('src', currentDrink.img);
                        document.querySelector('.cocktail-card').classList.remove('hidden');
                        document.querySelector('.recipe-card').classList.add('hidden');
                    });

                    document.getElementById('recipeButton').addEventListener('click', function () {
                        if (currentDrink) {
                            document.getElementById('technique').innerText = currentDrink.technique;

                            

                            // Helper function to ensure cocktail properties are arrays
                            const toArray = (value) => {
                                if (value === undefined || value === null) {
                                    return [];
                                }
                                return Array.isArray(value) ? value : [value];
                            };

                            // Convert glass object to HTML string
                            const glassHTML = toArray(currentDrink.glass).map(item => `<div>${item}</div>`).join('');

                            // Assuming modalGlass is your HTML element where you want to display the glass type
                            document.getElementById('glass').innerHTML = glassHTML;

                            // Convert recipe array to HTML string
                            const recipeHTML = toArray(currentDrink.recipe).map(item => `<div>${item}</div>`).join('');
                            document.getElementById('ingredients').innerHTML = recipeHTML;

                            // Convert garnish array to HTML string
                            const garnishHTML = toArray(currentDrink.garnish).map(item => `<div>${item}</div>`).join('');
                            document.getElementById('garnish').innerHTML = garnishHTML;

                            document.querySelector('.cocktail-card').classList.add('hidden');
                            document.querySelector('.recipe-card').classList.remove('hidden')

                        }
                    });
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        });
    </script>
</body>

</html>